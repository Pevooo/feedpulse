(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[57124],{473631:function(e,t,n){"use strict";t.Li=function(e,t,n="HH:mm"){if(!e.startsWith("UTC "))throw new Error(`getLocalTime only supprots UTC time. Date ${e} is not supported`);const s=e.slice(3),o=r.default.utc(s,"YYYY-MM-DD HH:mm:ss"),a=i.default.last(t.split(" "));if(!a?.startsWith("GMT"))throw new Error(`timezone ${t} is not supported. Please update configuration if we need to support it!`);const u=i.default.toNumber(a.slice(3));if(!i.default.isNumber(u))throw new Error(`timezone ${t} is not supported. Please update configuration if we need to support it!`);return o.utcOffset(u).format(n)},t.ZP=void 0;var i=s(n(298784)),r=s(n(951154));function s(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n="seconds"){if(e&&t)return r.default(e).utc().diff(r.default(t).utc(),n)}var a=o;t.ZP=a},707814:function(e,t,n){"use strict";t.Gj=l,t.Qs=function e(t){if(!t)return[];const n=[];for(const i of t){const t=i;l(i)&&(t.subchoices=e(i.subchoices)),n.push(t)}return n.sort(f)},t.BG=function(e,t=new Set,n={}){const i=(e,r=0,s=!1,o=new Set,a)=>{o.add(e);const d=s||t.has(e.choice+r);a=n[e.choice]??a;const l=u.default.map(u.default.filter(e.subchoices,(e=>!o.has(e))),(e=>i(e,r+1,d,o,a))),c=u.default.sortBy(l,(([{subtreeSize:e,subchoices:t}])=>e>0?0:t&&t.length>0?1:2)),f=u.default.sumBy(l,(([{subtreeSize:e}])=>e));return[{...e,depth:r,flagged:s,color:a,subtreeSize:f+1},...u.default.flatten(c)]};return i(e)},t.rQ=function e(t){return Object.keys(t).reduce(((n,i)=>{const r=t[i];return r.subchoices?n.push({choice:i,display:r.display,subchoices:e(r.subchoices)}):n.push({choice:i,display:r.display}),n}),[])},t.EW=function e(t,n,i=[]){for(const[r,s]of t.entries()){if(s.choice===n)return i.concat([r]);if(s.subchoices){const t=e(s.subchoices,n,i.concat([r]));if(t.length>0)return t}}return[]},t.Ak=function e(t){return t?Object.values(t).reduce(((t,n)=>(t+=e(n.subchoices),t+1)),0):0},t.Jo=function e(t,n,i,r=new Set){r.add(t);const s=(t.display??t.choice).toLowerCase().includes(n.toLowerCase()),o=i||s,a=[],u=new Set,d=new Set;if(t.subchoices){const i=t.subchoices.filter((e=>!r.has(e)));for(const t of i){const i=e(t,n,o,r);i.node&&a.push(i.node),i.matches.forEach((e=>u.add(e))),i.matchesString.forEach((e=>d.add(e)))}}if(o||a.length>0||"root"===t.choice){const e={...t,subchoices:a};return s&&(u.add(e),d.add(e.choice)),{node:e,matches:u,matchesString:d}}return{node:void 0,matches:u,matchesString:d}},t.p3=v,t.NA=g,t.Ek=void 0;var i,r,s,o,a,u=(i=n(298784))&&i.__esModule?i:{default:i};function d(e){const t=[];for(const n of e){const e=c(n);if(!e||""===e)throw new Error("The provided ontology has a choice which is undefined, null, or empty");t.push(e),l(n)&&t.push(...d(n.subchoices))}return t}function l(e){const t=u.default.get(e,"subchoices");return u.default.isArray(t)&&!u.default.isEmpty(t)}function c(e){return u.default.isNil(e)?"":"string"===typeof e?e:e.choice}function f(e,t){const n=(e.display??e.choice).toUpperCase(),i=(t.display??t.choice).toUpperCase();return n.localeCompare(i)}function h(e,t){return e.reduce(((e,{choice:n,display:i,subchoices:r,attributes:s})=>(e[n]={display:i,...r?.length&&{subchoices:h(r,t)},...t&&s&&{attributes:s}},e)),{})}function p(e,t=[],n){return e.reduce(((e,i)=>{const{choice:r,display:s,subchoices:o,attributes:a}=i;return o?.length&&Object.assign(e,p(o,[...t],u.default.pick(i,["choice","display","attributes"]))),e[r]={path:t,...u.default.omitBy({display:s,attributes:a,parent:n},u.default.isNil)},e}),{})}function b(e,t){if(!e&&!t)return;const n=[],i=[],r=[];return u.default.forEach(e,((e,s)=>{const o=t?.[s];u.default.isEqual(e,o)||(o?e.global!==o.global?(i.push(s),n.push(s)):r.push(s):i.push(s))})),u.default.keys(t).forEach((t=>{e?.[t]||n.push(t)})),u.default.omitBy({added:n,deleted:i,edited:r},(e=>!e.length))}function v(e,t){if(!t)return{ontologyFlags:void 0,annotations:e};const n={},i=e.map((e=>{if(!e.uuid||!e.label||!t[e.label])return e;const i=u.default.cloneDeep(e);n[e.uuid]={descriptions:[],confirmed:!1};const r=t[e.label];let s=null;if(r.deleted&&(s="box",n[e.uuid].descriptions.push(`DELETED: Class ${r.deleted.previous.display} was deleted.`)),r.moved){let t;s=r.moved.newChoice.choice,t=r.moved.newChoice.choice===r.moved.previousChoice?.choice?`MOVED: Class ${r.moved.previousChoice.display} was moved under ${r.moved.newParent?r.moved.newParent.display:"root"}`:`MOVED: Class was moved from ${r.moved.previousChoice?.display||"previous class"} to ${r.moved.newChoice.display}`,n[e.uuid].descriptions.push(t),i.attributes=u.default.isArray(e.attributes)?Array(e.attributes.length).fill({}):{}}if(r.edited&&(r.edited.display&&n[e.uuid].descriptions.push(`EDITED: Class was renamed from ${r.edited.display.previousDisplay} to ${r.edited.display.newDisplay}`),r.edited.newSubchoices&&n[e.uuid].descriptions.push("EXPANDED: New subchoices added"),u.default.some(["added","edited"],(e=>u.default.has(r.edited?.attributes,e)))&&(n[e.uuid].descriptions.push("EDITED: Attributes were updated"),n[e.uuid].attributes={...u.default.fromPairs(u.default.map(r.edited.attributes?.added,(e=>[e,{description:`ADDED: ${e} was added`,confirmed:!1}]))),...u.default.fromPairs(u.default.map(r.edited.attributes?.edited,(e=>[e,{description:`EDITED: ${e} was edited`,confirmed:!1}])))}),r.edited.attributes?.edited||r.edited.attributes?.deleted)){const e=u.default.union(r.edited.attributes.edited,r.edited.attributes.deleted);i.attributes=u.default.isArray(i.attributes)?u.default.map(i.attributes,(t=>t&&u.default.omit(t,e))):i.attributes=u.default.omit(i.attributes,e)}return n[e.uuid].descriptions.length||delete n[e.uuid],s&&(i.label=s,i.frames&&(i.frames=i.frames.map((e=>e?{...e,label:s}:void 0)))),i}));return{ontologyFlags:n,annotations:i}}function g(e,t){const n=u.default.cloneDeep(e),i={};return t.deleted?.forEach((e=>{delete n[e]})),t.edited?.forEach((e=>{delete n[e],i[e]={description:`EDITED: ${e} was edited`,confirmed:!1}})),t.added?.forEach((e=>{i[e]={description:`ADDED: ${e} was added`,confirmed:!1}})),{newAttributes:n,newAttributeChanges:i}}function y(e,t){if(!t)return{events:e,eventFlags:{}};const n={};return{events:e.reduce(((e,i)=>{let r=i;if(t.deleted?.includes(i.label))return e;if(t.edited?.[i.label]){const{newAttributes:e,newAttributeChanges:s}=g(i.attributes,t.edited?.[i.label]);r={...i,attributes:e},n[i.id]={confirmed:!1,attributes:s,descriptions:["EDITED: Attributes were edited"]}}return[...e,r]}),[]),eventFlags:n}}(function(e){e.Added="Added",e.Edited="Edited",e.Deleted="Deleted",e.Moved="Moved"})(r||(r={})),function(e){e.Requested="Requested",e.InReview="In Review",e.Realigning="Realigning",e.Approved="Approved"}(s||(s={})),function(e){e.InReview="In Review",e.Approved="Approved",e.Rejected="Rejected"}(o||(o={})),function(e){e.Submitted="Submitted",e.InProgress="In Progress",e.Completed="Completed"}(a||(a={}));t.Ek=e=>{const t=e.ontologyVersion&&e.responseOntologyVersion&&e.ontologyVersion!==e.responseOntologyVersion?u.default.find(e.ontologyHistory,{_id:e.ontologyVersion})?.changeMaps?.[e.responseOntologyVersion]:void 0;if(!t)return{newAnnotations:e.annotations,newEvents:e.events};const{ontologyFlags:n,annotations:i}=v(e.annotations,t.ontology),{eventFlags:r,events:s}=y(e.events,t.events);return{newAnnotations:i,newEvents:s,ontologyChangeFlags:{...n,...r}}}},222091:function(e,t,n){var i;!function(r,s){var o=function(e){var t=["N","E","A","D"];function n(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function i(e,t){Object.defineProperty(this,"kind",{value:e,enumerable:!0}),t&&t.length&&Object.defineProperty(this,"path",{value:t,enumerable:!0})}function r(e,t,n){r.super_.call(this,"E",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0}),Object.defineProperty(this,"rhs",{value:n,enumerable:!0})}function s(e,t){s.super_.call(this,"N",e),Object.defineProperty(this,"rhs",{value:t,enumerable:!0})}function o(e,t){o.super_.call(this,"D",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0})}function a(e,t,n){a.super_.call(this,"A",e),Object.defineProperty(this,"index",{value:t,enumerable:!0}),Object.defineProperty(this,"item",{value:n,enumerable:!0})}function u(e,t,n){var i=e.slice((n||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,i),e}function d(e){var t=typeof e;return"object"!==t?t:e===Math?"math":null===e?"null":Array.isArray(e)?"array":"[object Date]"===Object.prototype.toString.call(e)?"date":"function"===typeof e.toString&&/^\/.*\//.test(e.toString())?"regexp":"object"}function l(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return t}function c(e){var t=0,n=d(e);if("array"===n)return e.forEach((function(e){t+=c(e)})),t+l("[type: array, hash: "+t+"]");if("object"===n){for(var i in e)if(e.hasOwnProperty(i)){var r="[ type: object, key: "+i+", value hash: "+c(e[i])+"]";t+=l(r)}return t}return t+l("[ type: "+n+" ; value: "+e+"]")}function f(e,t,n,i,u,l,h,p){n=n||[],h=h||[];var b=(u=u||[]).slice(0);if("undefined"!==typeof l&&null!==l){if(i){if("function"===typeof i&&i(b,l))return;if("object"===typeof i){if(i.prefilter&&i.prefilter(b,l))return;if(i.normalize){var v=i.normalize(b,l,e,t);v&&(e=v[0],t=v[1])}}}b.push(l)}"regexp"===d(e)&&"regexp"===d(t)&&(e=e.toString(),t=t.toString());var g,y,m,w,E=typeof e,D=typeof t,A="undefined"!==E||h&&h.length>0&&h[h.length-1].lhs&&Object.getOwnPropertyDescriptor(h[h.length-1].lhs,l),k="undefined"!==D||h&&h.length>0&&h[h.length-1].rhs&&Object.getOwnPropertyDescriptor(h[h.length-1].rhs,l);if(!A&&k)n.push(new s(b,t));else if(!k&&A)n.push(new o(b,e));else if(d(e)!==d(t))n.push(new r(b,e,t));else if("date"===d(e)&&e-t!==0)n.push(new r(b,e,t));else if("object"===E&&null!==e&&null!==t){for(g=h.length-1;g>-1;--g)if(h[g].lhs===e){w=!0;break}if(w)e!==t&&n.push(new r(b,e,t));else{if(h.push({lhs:e,rhs:t}),Array.isArray(e)){for(p&&(e.sort((function(e,t){return c(e)-c(t)})),t.sort((function(e,t){return c(e)-c(t)}))),g=t.length-1,y=e.length-1;g>y;)n.push(new a(b,g,new s(void 0,t[g--])));for(;y>g;)n.push(new a(b,y,new o(void 0,e[y--])));for(;g>=0;--g)f(e[g],t[g],n,i,b,g,h,p)}else{var O=Object.keys(e),C=Object.keys(t);for(g=0;g<O.length;++g)m=O[g],(w=C.indexOf(m))>=0?(f(e[m],t[m],n,i,b,m,h,p),C[w]=null):f(e[m],void 0,n,i,b,m,h,p);for(g=0;g<C.length;++g)(m=C[g])&&f(void 0,t[m],n,i,b,m,h,p)}h.length=h.length-1}}else e!==t&&("number"===E&&isNaN(e)&&isNaN(t)||n.push(new r(b,e,t)))}function h(e,t,n,i,r){var s=[];if(f(e,t,s,i,null,null,null,r),n)for(var o=0;o<s.length;++o)n(s[o]);return s}function p(e,t,n,i,r,s,o){return f(e,t,n,i,r,s,o,!0)}function b(e,t,n,i){var r=h(e,t,i?function(e){e&&i.push(e)}:void 0,n);return i||(r.length?r:void 0)}function v(e,t,n,i){var r=h(e,t,i?function(e){e&&i.push(e)}:void 0,n,!0);return i||(r.length?r:void 0)}function g(e,t,n){if(n.path&&n.path.length){var i,r=e[t],s=n.path.length-1;for(i=0;i<s;i++)r=r[n.path[i]];switch(n.kind){case"A":g(r[n.path[i]],n.index,n.item);break;case"D":delete r[n.path[i]];break;case"E":case"N":r[n.path[i]]=n.rhs}}else switch(n.kind){case"A":g(e[t],n.index,n.item);break;case"D":e=u(e,t);break;case"E":case"N":e[t]=n.rhs}return e}function y(e,n,i){if("undefined"===typeof i&&n&&~t.indexOf(n.kind)&&(i=n),e&&i&&i.kind){for(var r=e,s=-1,o=i.path?i.path.length-1:0;++s<o;)"undefined"===typeof r[i.path[s]]&&(r[i.path[s]]="undefined"!==typeof i.path[s+1]&&"number"===typeof i.path[s+1]?[]:{}),r=r[i.path[s]];switch(i.kind){case"A":i.path&&"undefined"===typeof r[i.path[s]]&&(r[i.path[s]]=[]),g(i.path?r[i.path[s]]:r,i.index,i.item);break;case"D":delete r[i.path[s]];break;case"E":case"N":r[i.path[s]]=i.rhs}}}function m(e,t,n){if(n.path&&n.path.length){var i,r=e[t],s=n.path.length-1;for(i=0;i<s;i++)r=r[n.path[i]];switch(n.kind){case"A":m(r[n.path[i]],n.index,n.item);break;case"D":case"E":r[n.path[i]]=n.lhs;break;case"N":delete r[n.path[i]]}}else switch(n.kind){case"A":m(e[t],n.index,n.item);break;case"D":case"E":e[t]=n.lhs;break;case"N":e=u(e,t)}return e}function w(e,t,n){if(e&&t&&n&&n.kind){var i,r,s=e;for(r=n.path.length-1,i=0;i<r;i++)"undefined"===typeof s[n.path[i]]&&(s[n.path[i]]={}),s=s[n.path[i]];switch(n.kind){case"A":m(s[n.path[i]],n.index,n.item);break;case"D":case"E":s[n.path[i]]=n.lhs;break;case"N":delete s[n.path[i]]}}}function E(e,t,n){e&&t&&h(e,t,(function(i){n&&!n(e,t,i)||y(e,t,i)}))}n(r,i),n(s,i),n(o,i),n(a,i),Object.defineProperties(b,{diff:{value:b,enumerable:!0},orderIndependentDiff:{value:v,enumerable:!0},observableDiff:{value:h,enumerable:!0},orderIndependentObservableDiff:{value:p,enumerable:!0},orderIndepHash:{value:c,enumerable:!0},applyDiff:{value:E,enumerable:!0},applyChange:{value:y,enumerable:!0},revertChange:{value:w,enumerable:!0},isConflict:{value:function(){return"undefined"!==typeof $conflict},enumerable:!0}}),b.DeepDiff=b,e&&(e.DeepDiff=b);return b}(r);void 0===(i=function(){return o}.call(t,n,t,e))||(e.exports=i)}(this)},505940:function(e,t,n){"use strict";n.d(t,{VC:function(){return d}});var i=n(413735),r=n(585912),s={isHistory:e=>(0,i.P)(e)&&Array.isArray(e.redos)&&Array.isArray(e.undos)&&(0===e.redos.length||r.OX.isOperationList(e.redos[0]))&&(0===e.undos.length||r.OX.isOperationList(e.undos[0]))},o=(new WeakMap,new WeakMap),a=new WeakMap,u={isHistoryEditor:e=>s.isHistory(e.history)&&r.ML.isEditor(e),isMerging:e=>a.get(e),isSaving:e=>o.get(e),redo(e){e.redo()},undo(e){e.undo()},withoutMerging(e,t){var n=u.isMerging(e);a.set(e,!1),t(),a.set(e,n)},withoutSaving(e,t){var n=u.isSaving(e);o.set(e,!1),t(),o.set(e,n)}},d=e=>{var t=e,{apply:n}=t;return t.history={undos:[],redos:[]},t.redo=()=>{var{history:e}=t,{redos:n}=e;if(n.length>0){var i=n[n.length-1];u.withoutSaving(t,(()=>{r.ML.withoutNormalizing(t,(()=>{for(var e of i)t.apply(e)}))})),e.redos.pop(),e.undos.push(i)}},t.undo=()=>{var{history:e}=t,{undos:n}=e;if(n.length>0){var i=n[n.length-1];u.withoutSaving(t,(()=>{r.ML.withoutNormalizing(t,(()=>{var e=i.map(r.OX.inverse).reverse();for(var n of e)t.apply(n)}))})),e.redos.push(i),e.undos.pop()}},t.apply=e=>{var{operations:i,history:r}=t,{undos:s}=r,o=s[s.length-1],a=o&&o[o.length-1],d=f(e,a),p=u.isSaving(t),b=u.isMerging(t);if(null==p&&(p=c(e)),p){if(null==b&&(b=null!=o&&(0!==i.length||(l(e,a)||d))),o&&b)d&&o.pop(),o.push(e);else{var v=[e];s.push(v)}for(;s.length>100;)s.shift();h(e)&&(r.redos=[])}n(e)},t},l=(e,t)=>"set_selection"===e.type||(!(!t||"insert_text"!==e.type||"insert_text"!==t.type||e.offset!==t.offset+t.text.length||!r.y$.equals(e.path,t.path))||!(!t||"remove_text"!==e.type||"remove_text"!==t.type||e.offset+e.text.length!==t.offset||!r.y$.equals(e.path,t.path))),c=(e,t)=>"set_selection"!==e.type||null!=e.properties&&null!=e.newProperties,f=(e,t)=>!(!t||"set_selection"!==e.type||"set_selection"!==t.type),h=e=>"set_selection"!==e.type}}]);